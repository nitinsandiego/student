---
hide: True
layout: post
title: Binary Puzzle
type: hacks
courses: {'csp': {'week': 14}}
---

<html>
<head>
    <title>Binary Puzzle</title>
    <style>
    </style>
</head>
<body>
    <div id="puzzle-container">
        <!-- Grid will be generated by JavaScript -->
    </div>
    <div id="controls">
        <button id="undo">Undo</button>
        <button id="redo">Redo</button>
        <div id="timer">Time: 00:00</div>
    </div>
    <script>
    let history = [];
    let currentStep = -1;
    let timerInterval;
    let startTime;
    function generateGrid(size) {
        const container = document.getElementById('puzzle-container');
        container.style.gridTemplateColumns = `repeat(${size}, 50px)`;
        for (let i = 0; i < size; i++) {
            for (let j = 0; j < size; j++) {
                const cell = document.createElement('div');
                cell.className = 'puzzle-cell';
                cell.addEventListener('click', () => toggleCellValue(cell, true));
                container.appendChild(cell);
            }
        }
        startTimer();
        bindButtons();
    }
    function toggleCellValue(cell, addToHistory) {
        if (addToHistory) {
            saveHistory();
        }
        if (cell.textContent === '') {
            cell.textContent = '1';
        } else if (cell.textContent === '1') {
            cell.textContent = '0';
        } else {
            cell.textContent = '';
        }
        if (isPuzzleValid()) {
            alert("Congratulations! You solved the puzzle.");
        }
    }
    function startTimer() {
        startTime = new Date();
        timerInterval = setInterval(updateTimer, 1000);
    }
    function updateTimer() {
        const currentTime = new Date();
        const elapsed = new Date(currentTime - startTime);
        const minutes = elapsed.getUTCMinutes();
        const seconds = elapsed.getUTCSeconds();
        document.getElementById('timer').textContent = `Time: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    function saveHistory() {
        const state = Array.from(document.querySelectorAll('.puzzle-cell')).map(cell => cell.textContent);
        history = history.slice(0, currentStep + 1);
        history.push(state);
        currentStep++;
    }
    function undo() {
        if (currentStep > 0) {
            currentStep--;
            restoreState(history[currentStep]);
        }
    }
    function redo() {
        if (currentStep < history.length - 1) {
            currentStep++;
            restoreState(history[currentStep]);
        }
    }
    function restoreState(state) {
        const cells = document.querySelectorAll('.puzzle-cell');
        state.forEach((value, index) => {
            cells[index].textContent = value;
        });
    }
    function bindButtons() {
        document.getElementById('undo').addEventListener('click', undo);
        document.getElementById('redo').addEventListener('click', redo);
    }
    function isPuzzleValid() {
        const size = 6; // assuming a 6x6 grid
        for (let i = 0; i < size; i++) {
            if (!checkRow(i, size) || !checkColumn(i, size)) {
                return false;
            }
        }
        return isPuzzleComplete(); // Check if the puzzle is complete
    }
    function isPuzzleComplete() {
        // Check if all cells are filled and the puzzle follows the rules
        const cells = document.querySelectorAll('.puzzle-cell');
        for (let cell of cells) {
            if (cell.textContent === '') {
                return false; // Puzzle is not complete if any cell is empty
            }
        }
        return true;
    }
    function checkRow(row, size) {
        let count = { '0': 0, '1': 0, '': 0 };
        let lastValue = null, repeat = 0;
        for (let col = 0; col < size; col++) {
            let cellIndex = row * size + col;
            let value = document.querySelectorAll('.puzzle-cell')[cellIndex].textContent;
            count[value]++;
            if (value === lastValue) {
                repeat++;
                if (repeat > 1 && value !== '') return false; // More than two same numbers adjacent
            } else {
                repeat = 0;
            }
            lastValue = value;
        }
        return count['0'] === count['1'] || count[''] > 0; // Equal number of '0's and '1's or empty cells present
    }
    function checkColumn(col, size) {
        let count = { '0': 0, '1': 0, '': 0 };
        let lastValue = null, repeat = 0;
        for (let row = 0; row < size; row++) {
            let cellIndex = row * size + col;
            let value = document.querySelectorAll('.puzzle-cell')[cellIndex].textContent;
            count[value]++;
            if (value === lastValue) {
                repeat++;
                if (repeat > 1 && value !== '') return false; // More than two same numbers adjacent
            } else {
                repeat = 0;
            }
            lastValue = value;
        }
        return count['0'] === count['1'] || count[''] > 0; // Equal number of '0's and '1's or empty cells present
    }
    document.addEventListener('DOMContentLoaded', () => {
        generateGrid(6); // Initialize 6x6 grid
    });
</script>

</body>
</html>
